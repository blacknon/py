#!/usr/bin/env bats

com=./py

@test "pattern" {
  result=$(seq 10 | $com 'F1%2==0' | xargs )
  [ "$result" == '2 4 6 8 10' ]
}

@test "action" {
  result=$(echo 1 2 3 a b c | $com '[ F2, F3*3, F5+"aaa"]')
  [ "$result" = "2 9 baaa" ]
}

@test "pattern and action" {
  result=$(seq 4 | $com 'F1%2==0[F1, ":even"]' | xargs)
  [ "$result" = "2 :even 4 :even" ]
}

@test "module import" {
  result=$( echo 3.141592 | ./py -m "import math" '[round(math.sin(F1/4),3)]' )
  [ "$result" = "0.707" ]
}
